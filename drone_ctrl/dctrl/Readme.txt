
=================================================================================
■■■未リリース■■■
Rev 2022.08.19-2
-------------------------------------------------------------
機体制御プログラム: ~/drone_ctrl/ardctrl.py
検証用制御画面: /var/www/html/simpel_gcs/html/index.html
-------------------------------------------------------------
【変更点】
・各WP移動時の速度を設定（これ以前のVerでは10固定）
　ardctrl.pyの差し替えが必要
  index.html
  map_ctrl.js
・GUIDED時の回転、移動、高度変更の処理をMQTTのon_messageコールバックから
　メイン処理部へ移動
　→　コールバックで重い処理を行うと、処理中にMQTT送受信が行われないため。


=================================================================================
Rev 2022.08.19
-------------------------------------------------------------
機体制御プログラム: ~/drone_ctrl_0819/ardctrl.py
検証用制御画面: /var/www/html/contents_0819/html/index.html
-------------------------------------------------------------

【新規対応】
（１）機体回転（GUIDEDモード時のみ動作します）
現在のヘディング方向からの相対角度を指定してヘディング方向を変更する機能
　正値を設定した場合：右（ＣＷ）回転
　負値を設定した場合：左（ＣＣＷ）回転
設定例
　Droneコマンド「ROTATE」を設定してコマンドを送信します。
　  drone_command = {
      "operation":"ROTATE",  # コマンド: ROTATE
      "subcode":"",       # 設定不要
      "d_lat":"0",        # 設定不要 
      "d_lon":"0",        # 設定不要 
      "d_alt":"30.0",      # 現在高度からの相対角度（この場合、30度右回転します） 
      "d_spd":"0"         # 設定不要 
    }

（２）へディング方向への移動（GUIDEDモード時のみ動作します）
現在位置から進行方向へ設定位置分移動する機能
進行方向前後方向をX、進行方向左右方向をYで設定
　Xに正値を設定した場合：前進
　Xに負値を設定した場合：後進
　Yに正値を設定した場合：右方向移動
　Yに負値を設定した場合：左方向移動
設定例
　Droneコマンド「MOVE」を設定してコマンドを送信します。
　  drone_command = {
      "operation":"MOVE", # コマンド: MOVE
      "subcode":"",       # 設定不要
      "d_lat":"3.0",      # X方向（前後）設定 
      "d_lon":"2.0",      # Y方向（左右）設定 
      "d_alt":"0",        # 設定不要 
      "d_spd":"0"         # 設定不要 
    }
    上記設定の場合、前方3.0m、右方向2.0mの位置（斜め方向）へ移動します。

（３）高度変更（GUIDEDモード時のみ動作します）
現在高度から相対高度を指定して対地高度を変更する機能
　正値を設定した場合：上昇
　負値を設定した場合：降下
設定例
　Droneコマンド「ALT」を設定してコマンドを送信します。
　  drone_command = {
      "operation":"ALT",  # コマンド: ALT
      "subcode":"",       # 設定不要
      "d_lat":"0",        # 設定不要 
      "d_lon":"0",        # 設定不要 
      "d_alt":"1.0",      # 現在高度からの相対高度値（この場合、1.0m上昇します） 
      "d_spd":"0"         # 設定不要 
    }


※現状把握している懸念事項
（１）、（２）の動作時にMQTT送信がされないためか、画面へのステータス反映
ができない。機体自体はシームレスに動作している。
→　原因はMQTTのon_messageコールバック内で実行しているため、処理中にMQTT送信が行われない
ため。時期Varで修正予定

【　修正点　】
・ミッション中断時にウェイポイントアクションが実行され続ける現象を修正
・最後のウェイポイントでウェイポイントアクションが実行されない不具合を修正

=================================================================================

Rev 2022.08.16
【　修正点　】
・ミッション連続実行時の不具合対策
2回目の実行時にAUTOにならない、原因はミッション実行後ミッションデータを破棄して
クリアするが、データをアップロードしていない場合もミッション実行ループが実行
可能になっていたため、アップロード後で無いとMISSIONが実行されないように修正

・ミッションアップロード時、起動後１回目のアップロードWP数が設定値より少なくなる
現象の対策
→　アップロードデータ数とアップロードされたデータ数を比較して、一致しない場合、
一致するまでアップロードを繰り返す。
懸念点：永遠に一致しない場合は永久ループになるため対策が必要

・ミッション実行時のみしかAUTOモードに変更できないように修正

=================================================================================
